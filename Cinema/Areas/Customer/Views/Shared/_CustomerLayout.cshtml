@using Cinema.Models
@using Microsoft.AspNetCore.Identity
@inject UserManager<ApplicationUser> UserManager

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>MyShowz - @ViewData["Title"]</title>

    <!-- Favicon -->
    <link rel="icon" href="~/assets/images/favicon.ico" type="image/x-icon">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="~/assets/css/style-starter.css">
    <link href="//fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;1,600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz:400,700" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" />
    <link rel="stylesheet" href="https://npmcdn.com/flickity@2/dist/flickity.css">

    <link rel="stylesheet" type="text/css" href="~/assets/css/progress.css">
    <link rel="stylesheet" type="text/css" href="~/assets/css/ticket-booking.css">
    <link rel="stylesheet" type="text/css" href="~/assets/css/e-ticket.css">
    <link rel="stylesheet" type="text/css" href="~/assets/css/payment.css" />

    <!-- Custom styles -->
    <style>
        .Login_SignUp .dropdown-menu {
            left: auto;
            right: 0;
            min-width: 160px;
        }

        .Login_SignUp .dropdown-item {
            padding: 10px 20px;
        }

        .Login_SignUp .btn-link {
            width: 100%;
            text-align: left;
            padding: 10px 20px;
            color: #333;
            border: none;
            background: none;
        }

            .Login_SignUp .btn-link:hover {
                color: #f36140;
                background-color: #f8f9fa;
                text-decoration: none;
            }

        .Login_SignUp .nav-link {
            display: flex;
            align-items: center;
            gap: 8px;
        }

            .Login_SignUp .nav-link .fa-user-circle-o {
                font-size: 1.8rem;
            }

            .Login_SignUp .nav-link span {
                font-size: 0.9rem;
            }

        .Login_SignUp .profile-img {
            width: 30px;
            height: 30px;
            object-fit: cover;
            margin-right: 8px;
        }

        /* Footer Styling */
        .w3l-footer {
            background: #1a1a2e;
            color: #fff;
            margin-top: 60px;
        }

        .footer-content {
            background: #16213e;
            padding: 50px 0 30px;
        }

        .footer-title-29 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #fff;
            position: relative;
            padding-bottom: 10px;
        }

            .footer-title-29::after {
                content: "";
                position: absolute;
                left: 0;
                bottom: 0;
                width: 50px;
                height: 3px;
                background: #f36140;
            }

        .footer-list-29 p {
            color: #b8b8b8;
            line-height: 1.8;
            margin-bottom: 0;
        }

        .footer-list-29 ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

            .footer-list-29 ul li {
                margin-bottom: 10px;
            }

                .footer-list-29 ul li a {
                    color: #b8b8b8;
                    text-decoration: none;
                    transition: all 0.3s ease;
                    display: inline-block;
                }

                    .footer-list-29 ul li a:hover {
                        color: #f36140;
                        padding-left: 5px;
                    }

        .footer-contact li {
            display: flex;
            align-items: flex-start;
            margin-bottom: 12px;
        }

            .footer-contact li span {
                margin-right: 10px;
                color: #f36140;
                margin-top: 3px;
            }

            .footer-contact li a {
                color: #b8b8b8;
            }

        .below-section {
            background: #0f1419;
            padding: 20px 0;
        }

        .copyright-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

            .copyright-footer p {
                color: #b8b8b8;
                margin: 0;
                font-size: 14px;
            }

        .social {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            gap: 10px;
        }

            .social li a {
                display: flex;
                align-items: center;
                justify-content: center;
                width: 40px;
                height: 40px;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 50%;
                color: #fff;
                transition: all 0.3s ease;
            }

                .social li a:hover {
                    background: #f36140;
                    transform: translateY(-3px);
                }

        #movetop {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #f36140;
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: none;
            z-index: 999;
            box-shadow: 0 5px 15px rgba(243, 97, 64, 0.4);
            transition: all 0.3s ease;
        }

            #movetop:hover {
                background: #d64a2e;
                transform: translateY(-3px);
            }

        @@media (max-width: 768px) {
            .copyright-footer {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }

            .social {
                justify-content: center;
            }

            .footer-title-29::after {
                left: 50%;
                transform: translateX(-50%);
            }

            .footer-list-29 {
                text-align: center;
            }

            .footer-contact li {
                justify-content: center;
            }
        }
    </style>
</head>

<body>
    @{
        ApplicationUser currentUser = null;
        if (User.Identity.IsAuthenticated)
        {
            currentUser = await UserManager.GetUserAsync(User);
        }
    }

    <!-- Header -->
    <header id="site-header" class="w3l-header fixed-top">
        <nav class="navbar navbar-expand-lg navbar-light fill px-lg-0 py-0 px-3">
            <div class="container">
                <h1>
                    <a class="navbar-brand" asp-area="Customer" asp-controller="Home" asp-action="Index">
                        <span class="fa fa-play icon-log" aria-hidden="true"></span>
                        MyShowz
                    </a>
                </h1>
                <button class="navbar-toggler collapsed" type="button" data-toggle="collapse"
                        data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="fa icon-expand fa-bars"></span>
                    <span class="fa icon-close fa-times"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item @(ViewContext.RouteData.Values["Controller"]?.ToString() == "Home" && ViewContext.RouteData.Values["Action"]?.ToString() == "Index" ? "active" : "")">
                            <a class="nav-link" asp-area="Customer" asp-controller="Home" asp-action="Index">Home</a>
                        </li>
                        <li class="nav-item @(ViewContext.RouteData.Values["Controller"]?.ToString() == "Movies" ? "active" : "")">
                            <a class="nav-link" asp-area="Customer" asp-controller="Movies" asp-action="Index">Movies</a>
                        </li>
                        <li class="nav-item @(ViewContext.RouteData.Values["Controller"]?.ToString() == "About" ? "active" : "")">
                            <a class="nav-link" asp-area="Customer" asp-controller="About" asp-action="Index">About</a>
                        </li>
                        <li class="nav-item @(ViewContext.RouteData.Values["Controller"]?.ToString() == "Contact" ? "active" : "")">
                            <a class="nav-link" asp-area="Customer" asp-controller="Contact" asp-action="Index">Contact</a>
                        </li>
                    </ul>

                    <!-- Search Right -->
                    <div class="search-right">
                        <a href="#search" class="btn search-hny mr-lg-3 mt-lg-0 mt-4" title="Search">
                            Search <span class="fa fa-search ml-3" aria-hidden="true"></span>
                        </a>
                        <!-- Search Popup -->
                        <div id="search" class="pop-overlay">
                            <div class="popup">
                                <form action="#" method="post" class="search-box">
                                    <input type="search" placeholder="Search your Keyword" name="search" required="required" autofocus="">
                                    <button type="submit" class="btn">
                                        <span class="fa fa-search" aria-hidden="true"></span>
                                    </button>
                                </form>
                                <div class="browse-items">
                                    <h3 class="hny-title two mt-md-5 mt-4">Browse all:</h3>
                                    <ul class="search-items">
                                        <li><a href="movies.html">Action</a></li>
                                        <li><a href="movies.html">Drama</a></li>
                                        <li><a href="movies.html">Family</a></li>
                                        <li><a href="movies.html">Thriller</a></li>
                                        <li><a href="movies.html">Comedy</a></li>
                                        <li><a href="movies.html">Romantic</a></li>
                                        <li><a href="movies.html">Tv-Series</a></li>
                                        <li><a href="movies.html">Horror</a></li>
                                    </ul>
                                </div>
                            </div>
                            <a class="close" href="#close">×</a>
                        </div>
                        <!-- /Search Popup -->
                    </div>

                    <!-- Login/SignUp Dropdown -->
                    <div class="dropdown Login_SignUp">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="userDropdown"
                           role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            @if (User.Identity.IsAuthenticated && currentUser != null)
                            {
                                if (!string.IsNullOrEmpty(currentUser.ProfilePicture))
                                {
                                    <img src="@currentUser.ProfilePicture" alt="Profile" class="rounded-circle profile-img">
                                }
                                else
                                {
                                    <i class="fa fa-user-circle-o" style="font-size:1.8rem;margin-right:8px;"></i>
                                }
                                <span>@currentUser.UserName</span>
                            }
                            else
                            {
                                <i class="fa fa-user-circle-o" style="font-size:1.8rem;margin-right:8px;"></i>
                                <span>Account</span>
                            }
                        </a>

                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
                            @if (User.Identity.IsAuthenticated)
                            {
                                <a class="dropdown-item" asp-area="Identity" asp-controller="Profile" asp-action="Profile">My Profile</a>
                                <form asp-area="Identity" asp-controller="Account" asp-action="Logout" method="post" class="d-inline">
                                    <button type="submit" class="dropdown-item btn btn-link">Logout</button>
                                </form>
                            }
                            else
                            {
                                <a class="dropdown-item" asp-area="Identity" asp-controller="Account" asp-action="Login">Login</a>
                                <a class="dropdown-item" asp-area="Identity" asp-controller="Account" asp-action="Register">Sign Up</a>
                            }
                        </div>
                    </div>

                    <!-- Dark/Light Theme Switch -->
                    <div class="mobile-position">
                        <nav class="navigation">
                            <div class="theme-switch-wrapper">
                                <label class="theme-switch" for="checkbox">
                                    <input type="checkbox" id="checkbox">
                                    <div class="mode-container">
                                        <i class="gg-sun"></i>
                                        <i class="gg-moon"></i>
                                    </div>
                                </label>
                            </div>
                        </nav>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Main Content Area -->
    <main role="main" class="container-fluid px-0">
        @RenderBody()
    </main>

    <!-- Footer -->
    <footer class="w3l-footer">
        <section class="footer-inner-main">
            <div class="footer-content py-4">
                <div class="container">
                    <div class="row footer-top">
                        <div class="col-lg-4 col-md-6 footer-list-29">
                            <h6 class="footer-title-29">About MyShowz</h6>
                            <p>Your ultimate destination for booking movie tickets online. Enjoy the latest movies with the best cinema experience.</p>
                        </div>
                        <div class="col-lg-4 col-md-6 footer-list-29 mt-md-0 mt-4">
                            <h6 class="footer-title-29">Quick Links</h6>
                            <ul>
                                <li><a asp-area="Customer" asp-controller="Home" asp-action="Index">Home</a></li>
                                <li><a asp-area="Customer" asp-controller="Movies" asp-action="Index">Movies</a></li>
                                <li><a asp-area="Customer" asp-controller="About" asp-action="Index">About Us</a></li>
                                <li><a asp-area="Customer" asp-controller="Contact" asp-action="Index">Contact</a></li>
                            </ul>
                        </div>
                        <div class="col-lg-4 col-md-6 footer-list-29 mt-lg-0 mt-4">
                            <h6 class="footer-title-29">Contact Info</h6>
                            <ul class="footer-contact">
                                <li><span class="fa fa-map-marker"></span> Giza, Egypt</li>
                                <li><span class="fa fa-phone"></span> <a href="tel:+201234567890">+20 123 456 7890</a></li>
                                <li><span class="fa fa-envelope"></span> <a href="mailto:info@myshowz.com">info@myshowz.com</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="below-section">
                <div class="container">
                    <div class="copyright-footer">
                        <div class="columns text-lg-left">
                            <p>&copy; @DateTime.Now.Year MyShowz. All rights reserved | Developed with <span class="fa fa-heart text-danger"></span></p>
                        </div>
                        <ul class="social text-lg-right">
                            <li><a href="#facebook" aria-label="Facebook"><span class="fa fa-facebook" aria-hidden="true"></span></a></li>
                            <li><a href="#linkedin" aria-label="LinkedIn"><span class="fa fa-linkedin" aria-hidden="true"></span></a></li>
                            <li><a href="#twitter" aria-label="Twitter"><span class="fa fa-twitter" aria-hidden="true"></span></a></li>
                            <li><a href="#google" aria-label="Google Plus"><span class="fa fa-google-plus" aria-hidden="true"></span></a></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Move Top button -->
            <button onclick="topFunction()" id="movetop" title="Go to top">
                <span class="fa fa-arrow-up" aria-hidden="true"></span>
            </button>
        </section>
    </footer>

    <!-- JavaScript includes - تم ترتيبهم حسب الأولوية -->
    <!-- jQuery يجب أن يكون أول حاجة -->
    <script src="~/assets/js/jquery-1.9.1.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="~/assets/js/bootstrap.min.js"></script>

    <!-- Plugin Scripts -->
    <script src="~/assets/js/easyResponsiveTabs.js"></script>
    <script src="~/assets/js/owl.carousel.js"></script>
    <script src="~/assets/js/jquery.magnific-popup.min.js"></script>
    <script src="https://npmcdn.com/flickity@2/dist/flickity.pkgd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

    <!-- Theme Scripts -->
    <script src="~/assets/js/theme-change.js"></script>
    <script src="~/assets/js/ticket-booking.js"></script>

    <!-- Custom Scripts -->
    <script>
        (function($) {
            'use strict';

            // Easy Responsive Tabs
            $(document).ready(function () {
                $('#parentHorizontalTab').easyResponsiveTabs({
                    type: 'default',
                    width: 'auto',
                    fit: true,
                    tabidentify: 'hor_1',
                    activate: function (event) {
                        var $tab = $(this);
                        var $info = $('#nested-tabInfo');
                        var $name = $('span', $info);
                        $name.text($tab.text());
                        $info.show();
                    }
                });

                // Owl Carousel - Banner
                $('.owl-one').owlCarousel({
                    stagePadding: 280,
                    loop: true,
                    margin: 20,
                    nav: true,
                    responsiveClass: true,
                    autoplay: true,
                    autoplayTimeout: 5000,
                    autoplaySpeed: 1000,
                    autoplayHoverPause: false,
                    responsive: {
                        0: { items: 1, stagePadding: 40, nav: false },
                        480: { items: 1, stagePadding: 60, nav: true },
                        667: { items: 1, stagePadding: 80, nav: true },
                        1000: { items: 1, nav: true }
                    }
                });

                // Owl Carousel - Three Items
                $('.owl-three').owlCarousel({
                    loop: true,
                    margin: 20,
                    nav: false,
                    responsiveClass: true,
                    autoplay: true,
                    autoplayTimeout: 5000,
                    autoplaySpeed: 1000,
                    autoplayHoverPause: false,
                    responsive: {
                        0: { items: 2, nav: false },
                        480: { items: 2, nav: true },
                        667: { items: 3, nav: true },
                        1000: { items: 5, nav: true }
                    }
                });

                // Owl Carousel - Mid
                $('.owl-mid').owlCarousel({
                    loop: true,
                    margin: 0,
                    nav: false,
                    responsiveClass: true,
                    autoplay: true,
                    autoplayTimeout: 5000,
                    autoplaySpeed: 1000,
                    autoplayHoverPause: false,
                    responsive: {
                        0: { items: 1, nav: false },
                        480: { items: 1, nav: false },
                        667: { items: 1, nav: true },
                        1000: { items: 1, nav: true }
                    }
                });

                // Magnific Popup
                $('.popup-with-zoom-anim').magnificPopup({
                    type: 'inline',
                    fixedContentPos: false,
                    fixedBgPos: true,
                    overflowY: 'auto',
                    closeBtnInside: true,
                    preloader: false,
                    midClick: true,
                    removalDelay: 300,
                    mainClass: 'my-mfp-zoom-in'
                });

                $('.popup-with-move-anim').magnificPopup({
                    type: 'inline',
                    fixedContentPos: false,
                    fixedBgPos: true,
                    overflowY: 'auto',
                    closeBtnInside: true,
                    preloader: false,
                    midClick: true,
                    removalDelay: 300,
                    mainClass: 'my-mfp-slide-bottom'
                });

                // Disable body scroll when navbar is active
                $('.navbar-toggler').click(function () {
                    $('body').toggleClass('noscroll');
                });
            });

            // Fixed Header on Scroll
            $(window).on("scroll", function () {
                var scroll = $(window).scrollTop();
                if (scroll >= 80) {
                    $("#site-header").addClass("nav-fixed");
                } else {
                    $("#site-header").removeClass("nav-fixed");
                }
            });

            // Main navigation Active Class
            $(".navbar-toggler").on("click", function () {
                $("header").toggleClass("active");
            });

            $(document).on("ready", function () {
                if ($(window).width() > 991) {
                    $("header").removeClass("active");
                }
                $(window).on("resize", function () {
                    if ($(window).width() > 991) {
                        $("header").removeClass("active");
                    }
                });
            });

            // Move Top Button
            window.onscroll = function () {
                scrollFunction();
            };

            function scrollFunction() {
                if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                    document.getElementById("movetop").style.display = "block";
                } else {
                    document.getElementById("movetop").style.display = "none";
                }
            }

            window.topFunction = function() {
                document.body.scrollTop = 0;
                document.documentElement.scrollTop = 0;
            };

            // Screen Selection Function
            let prevId = "1";

            window.onload = function () {
                var screenBtn = document.getElementById("screen-next-btn");
                if (screenBtn) {
                    screenBtn.disabled = true;
                }
            };

            window.timeFunction = function() {
                var screenBtn = document.getElementById("screen-next-btn");
                if (screenBtn) {
                    screenBtn.disabled = false;
                }
            };

            window.myFunction = function(id) {
                var prevElement = document.getElementById(prevId);
                var currentElement = document.getElementById(id);

                if (prevElement) {
                    prevElement.style.background = "rgb(243, 235, 235)";
                }
                if (currentElement) {
                    currentElement.style.background = "#df0e62";
                }
                prevId = id;
            };

        })(jQuery);
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>

</html>